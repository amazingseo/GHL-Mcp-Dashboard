{% extends "templates_base.html" %}

{% block title %}Speed Test{% endblock %}

{% block content %}
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="card shadow-sm">
        <div class="card-body p-4">
          <h1 class="h3 mb-3">Website Speed Test</h1>
          <form action="/api/speed-check" method="post" id="speedForm" novalidate>
            <div class="mb-3">
              <label for="url" class="form-label">URL</label>
              <input type="url" class="form-control" id="url" name="url" placeholder="https://example.com" required>
              <div class="form-text">Include http:// or https://</div>
            </div>
            <div class="d-grid">
              <button type="submit" class="btn btn-primary" id="speedBtn">
                <span class="btn-text">
                  <i class="fas fa-gauge-high me-2"></i> Analyze Speed
                </span>
                <span class="btn-loading d-none">
                  <span class="spinner-border spinner-border-sm me-2"></span>
                  Analyzing...
                </span>
              </button>
            </div>
          </form>
          <div id="speedProgress" class="alert alert-info mt-3 d-none">
            <i class="fas fa-circle-info me-2"></i> Running speed analysis...
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById('speedForm').addEventListener('submit', function(e) {
  const urlEl = document.getElementById('url');
  if (!urlEl.checkValidity()) {
    e.preventDefault();
    urlEl.classList.add('is-invalid');
    return;
  }
  const btn = document.getElementById('speedBtn');
  btn.disabled = true;
  btn.querySelector('.btn-text').classList.add('d-none');
  btn.querySelector('.btn-loading').classList.remove('d-none');
  document.getElementById('speedProgress').classList.remove('d-none');
});
</script>
{% endblock %}
